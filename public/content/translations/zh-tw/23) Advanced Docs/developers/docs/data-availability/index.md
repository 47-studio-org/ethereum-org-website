---
title: 資料可用性
description: 以太坊中的資料可得性問題與解決方案概覽
lang: zh-tw
---

「不輕易相信，而是去驗證。」是以太坊盛行的座右銘， 意為你的節點可以通過執行從同行那裡接收的區塊中的所有交易，獨立驗證接收到的信息是否正確，以確保所提出的變更與節點獨立計算的變更完全相符， 這意味著節點不需要信任區塊的發送者是否為可信的， 如有任何資料缺失則這無法實現。

**資料可得性**指的是用戶可以對所需資料的可得性有多大的信心，以驗證該區塊的數據是否真的對所有網絡參與者皆可用。 相對於以太坊第一層的完整節點來說這很簡單；完整節點下載每個區塊中的所有資料副本 - 資料_必須_可用於下載。 有缺失資料的區塊將被捨棄，不會被添加到區塊鏈上。 這就是「鏈上資料可得性」，是大一統區塊鏈（相較於充滿了擴容方案如 rollups 的不太一統的區塊鏈）的功能之一。 完整節點不會被騙接受無效的交易，因為它們會下載並執行每個交易。 然而，對於模組化的區塊鏈、L2 rollups 和light clients，資料可用性的情境更為複雜，需要一些更為精密的驗證程序。

## 先備知識 {#prerequisites}

讀者應該對於區塊鏈具備足夠的基本知識，特別是共識機制。 本頁面還假設讀者熟悉區塊、交易、節點、擴展解決方案以及其他相關主題。

## 資料可得性問題 {#the-data-availability-problem}

資料可得性問題是，需要向整個網路證明正在添加到區塊鏈的某些交易資料的總結形式確實代表一組有效的交易，但不要求所有的節點都下載所有的資料。 為了獨立地驗證區塊，所有交易的資料是必要的，但要求所有節點都要下載全部的交易資料是個擴容的瓶頸。 因此，資料可得性問題的解決方案是希望向不下載、不儲存資料的網路參與者，提供足夠的保證來代表所有交易的資料是可得、可供取用於驗證的。

[輕節點](/developers/docs/nodes-and-clients/light-clients)和[L2 卷（rollups）](/developers/docs/scaling)就是需要強力的資料可得性保證、但不會自行下載與處理交易資料的經典案例。 畢竟，不下載交易資料才能稱作「輕」節點，而卷（rollups）才能有效的擴容。

資料可得性問題也對未來的[無狀態](/roadmap/statelessness)以太坊客戶端來說至關重要，這樣他們才不需要下載及儲存狀態的資料來驗證區塊。 無狀態的客戶端仍需要確信資料在_某處_是可取得的，而且有被正確地處理。

## 資料可得性解決方案 {#data-availability-solutions}

### 資料可得性採樣（DAS） {#data-availability-sampling}

資料可得性採樣（DAS）是指讓網路能檢查資料是可取得的，但同時不在任何的獨立節點上加諸太多要求。 每個節點（包含沒有質押的節點）下載所有交易資料的隨機一小部分， 若能成功地下載到採樣，我們就能高度相信所有資料都是可得的。 這要仰賴於糾刪碼，把一組原本的資料塞入冗余的資訊（其原理是把資料套上稱為_多項式_的函式（function），然後在該多項式上找出其他點來作為冗余的資訊）。 這讓原本的資料在必要時，可以透過冗余的資料來還原。 這種資料處理方式的結果是，如果有_任何_原本的資料不可得，那擴增資料的_一半_就也會遺失。 而每個節點下載的資料採樣樹可以被調整，來確保如果真的只有不到一半的資料是可得的，那每個客戶端至少會有一個資料片段是缺失的。

資料可得性採樣可以用以確保在[Full Danksharding](/roadmap/danksharding/#what-is-danksharding)上線後，卷的交易處理者需要讓交易的資料是可得的。 以太坊節點會隨機地向 blob 中的資料採樣，用前述提到的糾刪碼來確保所有資料真的都存在。 同樣的技術也可以用來確保區塊製造者會讓所有的資料都是可得的，來保障輕節點的安全性。 同樣的，在[區塊提議、製造者分離（PBS）](/roadmap/pbs)中，只有區塊製造者需要處理整個區塊，驗證者（提議者）只要驗證資料可得性的採樣。

### 資料可得性委員會 {#data-availability-committees}

(DACs) 是提供或證明數據可用性的可信方。 DACs可以替代 [或與DAS一起共同使用。](https://hackmd.io/@vbuterin/sharding_proposal#Why-not-use-just-committees-and-not-DAS) 資料可用性委員會的安全保障取決於具體的設定。 例如，以太坊使用隨機抽樣一些驗證程式來證明節點的數據可用性。

validiums也在使用DACs。 DAC 是一組可信任的節點，離線儲存資料的副本。 DAC在發生爭議時需提供數據。 DAC的成員也得發布鏈上證明來證實所述數據正真的可用性。 有些 validiums 以權益證明驗證者系統（PoS）來代替 DAC。 在這裡，任何人都能成為驗證者並儲存鏈下資料。 然而，他們必須提供「保證金」並存款到智能合約中。 發生惡意行為時，如驗證者提供了欺騙性的資料，該保證金可能會受到罰沒。 權益證明資料可用性委員會在安全性方面明顯優於一般資料可用性委員，因為它們直接激勵誠實的行為。

## 資料可用性與輕節點 {#data-availability-and-light-nodes}

[輕量節點](/developers/docs/nodes-and-clients/light-clients)需要在不下載區塊資料的情況下驗證區塊標頭。 輕節點輕量化的代價就是無法像全節點一樣在本地獨立地重新執行交易以驗證區塊頭。

以太坊輕量節點信任被指派到_同步委員會_驗證者集合，該集合由 512 位驗證者組成。 同步委員會充當數據可用性委員會，使用加密簽名向輕節點表明區塊頭中的數據是正確的。 同步委員會每天都會刷新。 每個區塊標頭都會提醒輕量節點，哪些驗證者預計會簽署_下個_區塊，因此輕量節點不會被冒充成真的同步委員會的惡意團體欺騙。

但是，如果攻擊者_真的_找到某種方法，將惡意區塊標頭傳給輕量節點，並讓他們相信該區塊標頭是由誠實的同步委員會簽署的呢？ 在這種情況下，攻擊者可能會添加無效的交易，而輕節點將盲目地接受它們，因為輕節點無法獨立驗證匯總在區塊頭中的所有狀態變化。 為了防止這種情況，輕節點可以使用詐欺證明。

詐欺證明的工作原理如下：全節點發現一個無效狀態轉換在網路上廣播時，可以快速產生證明已提議狀態轉換不可能源自給定一組交易的一小段數據，並把這段數據廣播到對等節點。 輕節點可以選取這些詐欺證明並用來丟棄有害的區塊頭，確保它們和全節點留在相同的誠實區塊鏈上。

這仰仗於全節點能夠存取完整的交易資料。 廣播有害區塊頭並且不提供交易資料的攻擊者可能能夠阻止全節點產生詐欺證明。 全節點也許可以發出關於有害區塊的警告，但沒有證據來證明它們的警告，因為沒有可用於產生證明據的數據！

數據可用性採樣可以解決這個數據可用性問題。 輕節點下載完整狀態資料的小隨機片段，並使用這些樣本驗證完整資料集可用。 在下載 N 個隨機區塊後，可以算出「誤以為完整資料可用」的實際機率（例如，[下載 100 個區塊後的機率為10^-30](https://dankradfeist.de/ethereum/2019/12/20/data-availability-checks.html)，也就是說幾乎不可能發生）。

即使在這種情況下，僅保留幾個位元組的攻擊也可能被發出隨機資料請求的客戶端忽略。 刪除編碼透過重建缺失的小型資料片段來解決這個問題，這些片段可以用於檢查提交的狀態變更。 接著可以使用重建的資料建立欺詐證明，防止輕節點接受惡意的標頭。

**注意：** DAS 和 欺詐證明尚未在以太坊權益證明輕量節點中實作，不過有在路線圖上，很可能採用基於 ZK-SNARK 的證明形式。 現有的輕量節點依賴 DAC 的形式：他們驗證同步委員會的身份，並信任接收到的經簽署區塊標頭。

## 資料可用性與 Layer 2 卷軸 {#data-availability-and-layer-2-rollups}

[Layer 2 擴容解決方案](/layer-2/)，如[卷軸](/glossary/#rollups)，透過在鏈下處理交易，降低了交易成本並提升了以太坊的吞吐量。 卷軸交易是一批次一批次壓縮並上傳到以太坊上的。 批次指的是將數以千計的獨立鏈下交易壓成單一一筆以太坊上的交易。 這緩解了基礎層的擁塞情況，並降低了使用者所需支付的費用。

然而，只有當提交的狀態變化可被獨立驗證，並確認它確實是所有個別鏈下交易產出的結果時，我們才能信任這個上傳到以太坊的「總結」交易。 如果卷軸的營運者沒有在此驗證中提供交易資料，它們可能會發送錯誤的資料給以太坊。

[樂觀卷軸](/developers/docs/scaling/optimistic-rollups/)會上傳壓縮過的資料到以太坊上，並等待一段時間（一般來說是 7 天），以讓獨立的驗證者檢查資料。 如果任何人發現有問題，他們可以產生欺詐證明並用來挑戰卷軸。 這會導致區塊鏈回滾並忽略不合法的區塊。 只有在數據可用時，才能實現這一點。 目前，樂觀卷疊有兩種方式將交易資料發佈到一層網路。 有些卷軸使數據以 `CALLDATA` 的形式永久可用，並永久存在於鏈上。 隨著 EIP-4844 的實現，一些卷軸將其交易資料發佈到更便宜的二進位大型物件存儲中。 這不是永久的儲存。 獨立驗證者必須在資料從以太坊一層網路刪除前約 18 天内查詢二進位大型文件並提出挑戰。 資料有效性只在一個短暫的固定窗口期内由以太坊協議得到保證。 在此之後，資料可用性成爲以太坊生態系統中其他實體的責任。 任何節點都可以使用資料可用性采樣 (DAS) 來驗證數據可用性，即透過下載二進位大型物件資料的少量隨機樣本。

[零知識（ZK）卷軸](/developers/docs/scaling/zk-rollups)不需要上傳交易資料，因為[零知識有效性證明](/glossary/#zk-proof)已經保證了狀態轉換的真實性。 然而，資料可用性仍然是個問題，因為我們只有在存取狀態資料的情況下，才能確保零知識卷軸正常運作（或與其互動）。 例如，如果操作者扣留了卷軸的狀態，使用者就無法得知其餘額。 另外，使用者也無法使用新添加區塊中的資訊來執行狀態更新。

## 資料可用性與資料可檢索性 {#data-availability-vs-data-retrievability}

資料可用性與資料可檢索性不同。 資料可用性是一種保證，它確保全節點能夠訪問並驗證與特定區塊關聯的完整交易集。 這並不一定意味著數據能永遠被取出。

數據可檢索性是節點能夠從區塊鏈檢索_歷史資訊_的能力。 驗證新區塊不需要歷史資料，歷史資料只用於從創世區塊同步全節點或滿足某些特定的歷史請求。

核心以太坊協議主要關注數據可用性，而不是數據可檢索性。 資料可檢索性可以由第三方運行的少量存檔節點提供，也可以使用去中心化檔案儲存（例如 [入口網站）在網路上分散網路](https://www.ethportal.net/)。

## 延伸閱讀 {#further-reading}

- [資料可用性是什麼鬼？](https://medium.com/blockchain-capital-blog/wtf-is-data-availability-80c2c95ded0f)
- [什麽是資料可用性？](https://coinmarketcap.com/alexandria/article/what-is-data-availability)
- [以太坊鏈外資料可用性背景](https://blog.celestia.org/ethereum-off-chain-data-availability-landscape/)
- [資料可用性檢查入門](https://dankradfeist.de/ethereum/2019/12/20/data-availability-checks.html)
- [分片 + 資料可用性採樣 (DAS) 提案的解釋説明](https://hackmd.io/@vbuterin/sharding_proposal#ELI5-data-availability-sampling)
- [資料可用性和糾刪碼的説明](https://github.com/ethereum/research/wiki/A-note-on-data-availability-and-erasure-coding#can-an-attacker-not-circumvent-this-scheme-by-releasing-a-full-unavailable-block-but-then-only-releasing-individual-bits-of-data-as-clients-query-for-them)
- [資料可得性委員會.](https://medium.com/starkware/data-availability-e5564c416424)
- [權益證明資料可用性委員會。](https://blog.matter-labs.io/zkporter-a-breakthrough-in-l2-scaling-ed5e48842fbf)
- [資料可檢索性問題的解決方案](https://notes.ethereum.org/@vbuterin/data_sharding_roadmap#Who-would-store-historical-data-under-sharding)
- [資料可用性或：卷軸如何學會停止擔憂並熱愛以太坊](https://ethereum2077.substack.com/p/data-availability-in-ethereum-rollups) 
